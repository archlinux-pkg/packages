# Maintainer: MedzikUser <nivua1fn@duck.com>
_repo='Heroic-Games-Launcher/HeroicGamesLauncher'
_ver=v2.2.0
_auto_update=true

pkgname='heroic-games-launcher'
pkgdesc='A Native GUI Epic Games Launcher for Linux, Windows and Mac'
pkgver=2.2.0
pkgrel=1
arch=('x86_64')
url="https://github.com/${_repo}"
license=('GPL3')
makedepends=('git' 'nodejs' 'yarn' 'npm' 'libxcrypt')
optdepends=('legendary')
source=("${pkgname}::git+${url}#tag=${_ver}")
sha256sums=('SKIP')

build() {
  cd "${pkgname}"

  yarn --cache-folder "yarn-cache"
  yarn dist pacman
}

package() {
  cd "${pkgname}/dist"

  # Unpack package
  mkdir "pacman_unpack"
  tar xf heroic-*.pacman -C "pacman_unpack"

  # Install
  cd "pacman_unpack"
  cp -r --no-preserve=ownership --preserve=mode "usr" "opt" "${pkgdir}"
}
