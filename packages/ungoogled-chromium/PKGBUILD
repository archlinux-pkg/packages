# Maintainer: MedzikUser
_repo='ungoogled-software/ungoogled-chromium-archlinux'
_pkgver() {
  curl --location --silent "https://api.github.com/repos/$_repo/releases/latest" | jq -r '.tag_name'
}
_ver=$(_pkgver)

pkgname='ungoogled-chromium'
pkgver=${_ver//-/_}
pkgrel=1
pkgdesc='A lightweight approach to removing Google web service dependency'
arch=('x86_64')
url="https://github.com/Eloston/ungoogled-chromium"
license=('BSD')
depends=(
  'gtk3'
  'nss'
  'alsa-lib'
  'xdg-utils'
  'libxss'
  'libcups'
  'libgcrypt'
  'ttf-liberation'
  'systemd'
  'dbus'
  'libpulse'
  'pciutils'
  'libva'
  'desktop-file-utils'
  'hicolor-icon-theme')
optdepends=(
  'pipewire: WebRTC desktop sharing under Wayland'
  'kdialog: support for native dialogs in Plasma'
  'org.freedesktop.secrets: password storage backend on GNOME / Xfce'
  'kwallet: support for storing passwords in KWallet on Plasma')
provides=('chromium')
conflicts=('chromium')
source=("https://github.com/$_repo/releases/download/$_ver/ungoogled-chromium-$_ver-x86_64.pkg.tar.zst")
sha256sums=('SKIP')

prepare() {
  bsdtar -xf "$srcdir/ungoogled-chromium-$_ver-x86_64.pkg.tar.zst"
}

package() {
  cp -r "$srcdir/usr" "$pkgdir/"
}
